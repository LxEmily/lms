<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />

    <!-- Import CSS -->
    <link rel="stylesheet" type="text/css" th:href="@{~/css/common.css}" />
    <title>Home | Wet LMS</title>
  </head>

  <body class="m-0">
    <header th:replace="fragments/header.html :: notSignedIn"></header>

    <div
      th:if="${renewal}"
      class="toast shadow-lg position-fixed w-50 mb-4 mr-3"
      data-autohide="false"
      role="alert"
      aria-live="assertive"
      aria-atomic="true"
      style="z-index: 100; right: 0; bottom: 0; min-height: 100px;"
    >
      <div class="toast-header">
        <img
          class="rounded mr-2"
          style="max-height:25px; max-width: 25px;"
          th:src="@{~/images/logo/logo.png}"
        />
        <strong class="mr-auto">Wet LMS Bot</strong>
        <button
          type="button"
          class="ml-2 mb-1 close"
          data-dismiss="toast"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="toast-body ">
        <p
          th:text="${renewalFailed} ? ${renewalMsg} : ${renewalMsg}"
          th:class="${renewalFailed} ? 'alert alert-success' : 'alert alert-danger'"
        ></p>
      </div>
    </div>

    <main class="container mt-5 pl-5 pr-5">
      <div class="row">
        <div class="col hello-title">
          Hello <span th:text="${member.fullName}"></span>!
        </div>
      </div>

      <div class="row">
        <div class="col">
          <div class="title mb-3 border-bottom border-dark">
            Current Loans
          </div>
        </div>
      </div>
      <div class="row mb-5">
        <div
          class="col d-flex align-items-stretch mb-4"
          th:each="loan : ${loans}"
        >
          <div class="card shadow-lg artifact-card">
            <img
              th:src="@{~/images/test.png}"
              class="card-img-top border-bottom border-dark"
              alt="..."
            />
            <div class="card-body ">
              <h5 class="card-title" th:text="${loan.getArtifact().title}"></h5>
              <p
                class="card-text text-muted mb-4"
                th:text="${loan.getArtifact().authors}"
              ></p>
              <p class="card-text" th:text="${loan.getArtifact().genre}"></p>
              <h5>
                Due: <span th:text="${loan.getReturnOnAsString()}"></span>
              </h5>
              <div class="view-more">
                <button
                  type="button"
                  class="btn btn-outline-primary mr-2"
                  data-toggle="modal"
                  data-target="#renewModal"
                  th:attrappend="data-target=${loan.id}"
                >
                  Renew
                </button>
                <a href="#" class="btn btn-outline-primary ">View more</a>
              </div>
            </div>
          </div>

          <div
            class="modal fade text-center"
            id="renewModal"
            th:attrappend="id=${loan.id}"
            role="dialog"
          >
            <div class="modal-dialog modal-dialog-centered">
              <!-- Modal content-->
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title mx-auto">
                    Renew for how many days?
                  </h4>
                </div>
                <div class="modal-body ">
                  <a
                    th:href="@{/member/renew(id=${loan.id}, days='1')}"
                    class="btn btn-lg btn-outline-dark"
                    >1 Day</a
                  >
                  <a
                    th:href="@{/member/renew(id=${loan.id}, days='2')}"
                    class="btn btn-lg btn-outline-dark"
                    >2 Days</a
                  >
                  <a
                    th:href="@{/member/renew(id=${loan.id}, days='3')}"
                    class="btn btn-lg btn-outline-dark"
                    >3 Days</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal -->

      <div class=" row">
        <div class="col">
          <div class="title mb-3 border-bottom border-dark">
            Reserves
          </div>
        </div>
      </div>
      <div class="row mb-5">
        <div
          class="col d-flex align-items-stretch mb-4"
          th:each="loan : ${reservedLoans}"
        >
          <div class="card shadow-lg artifact-card">
            <img
              th:src="@{~/images/test.png}"
              class="card-img-top border-bottom border-dark"
              alt="..."
            />
            <div class="card-body ">
              <h5 class="card-title" th:text="${loan.getArtifact().title}"></h5>
              <p
                class="card-text text-muted mb-4"
                th:text="${loan.getArtifact().authors}"
              ></p>
              <p class="card-text" th:text="${loan.getArtifact().genre}"></p>
              <h5>
                Expires on:
                <span th:text="${loan.getExpiredOnAsString()}"></span>
              </h5>
              <div class="view-more">
                <a href="#" class="btn btn-outline-primary mr-2">Remove</a>
                <a href="#" class="btn btn-outline-primary ">View more</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row pt-5">
        <div class="col">
          <div class="title mb-3 border-bottom border-dark">
            Historical Loans
          </div>
        </div>
      </div>
      <div class="row">
        <div
          class="col d-flex align-items-stretch mb-4"
          th:each="loan : ${historicalLoans}"
        >
          <div class="card shadow-lg artifact-card">
            <img
              th:src="@{~/images/test.png}"
              class="card-img-top border-bottom border-dark"
              alt="..."
            />
            <div class="card-body ">
              <h5 class="card-title" th:text="${loan.getArtifact().title}"></h5>
              <p
                class="card-text text-muted mb-4"
                th:text="${loan.getArtifact().authors}"
              ></p>
              <p class="card-text" th:text="${loan.getArtifact().genre}"></p>
              <h5>
                Returned on:
                <span th:text="${loan.getReturnedOnAsString()}"></span>
              </h5>
              <div class="view-more">
                <a href="#" class="btn btn-outline-primary mr-2">Reserve</a>
                <a href="#" class="btn btn-outline-primary ">View more</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="mt-4 text-right link">
        <a
          class="btn btn-lg btn-outline-dark mb-5"
          th:href="@{/member/historical}"
          >More</a
        >
      </div>
    </main>

    <footer></footer>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>
    <script>
      $(".toast").toast("show");
    </script>
  </body>
</html>
